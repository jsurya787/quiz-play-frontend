<div
  class="fixed inset-0 z-[9999]
         flex items-center justify-center
         bg-black/60 backdrop-blur-md
         animate-fade-scale-in">

  <!-- üåå Ambient glow -->
  <div
    class="absolute -top-40 -left-40 h-[28rem] w-[28rem]
           rounded-full bg-indigo-400/35 blur-[160px]
           animate-float-slow">
  </div>

  <div
    class="absolute top-1/3 -right-40 h-[32rem] w-[32rem]
           rounded-full bg-sky-400/35 blur-[180px]
           animate-float-slower">
  </div>

  <!-- ‚ú® Floating sparkles -->
  <span class="absolute top-[20%] left-[45%] text-indigo-300/40 animate-sparkle">‚ú¶</span>
  <span class="absolute bottom-[25%] right-[42%] text-sky-300/40 animate-sparkle delay-200">‚ú¶</span>

  <!-- üßæ Modal -->
  <div
    class="relative z-10 w-full max-w-md
           rounded-3xl
           bg-white/85 backdrop-blur-xl
           shadow-[0_30px_80px_rgba(0,0,0,0.25)]
           border border-white/60
           p-8
           animate-pop">

    <!-- ‚ùå Close -->
    <button
      class="absolute top-4 right-4
             h-8 w-8 rounded-full
             flex items-center justify-center
             text-gray-400 hover:text-gray-700
             hover:bg-gray-100 transition"
      (click)="close.emit()">
      ‚úï
    </button>

    <!-- ‚úÖ SUCCESS -->
    @if (success()) {
      <div class="flex flex-col items-center py-10 animate-fade-scale-in">

        <!-- Glow ring -->
        <span
          class="absolute -inset-10 rounded-full
                 bg-indigo-500/30 blur-3xl
                 animate-pulse">
        </span>

        <div
          class="relative h-18 w-18 rounded-full
                 bg-gradient-to-br from-indigo-600 to-indigo-500
                 flex items-center justify-center
                 shadow-xl animate-check">

          <svg
            class="w-9 h-9 text-white"
            fill="none"
            stroke="currentColor"
            stroke-width="3"
            viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
          </svg>
        </div>

        <h2 class="mt-7 text-2xl font-extrabold text-gray-900">
          Password Set üéâ
        </h2>

        <p class="mt-2 text-sm text-gray-600 text-center">
          Your QuizPlay account is now fully secured.
        </p>
      </div>
    }

    <!-- üîê FORM -->
    @else {
      <h2 class="text-2xl font-extrabold text-gray-900">
        üîê Set Password
      </h2>

      <p class="mt-1 text-sm text-gray-600">
        Secure your <span class="font-semibold text-indigo-600">QuizPlay</span> account
      </p>

      <div class="mt-6 space-y-4">
        <input
          type="password"
          class="input focus:ring-2 focus:ring-indigo-400 transition"
          placeholder="New password"
          [(ngModel)]="password" />

        <input
          type="password"
          class="input focus:ring-2 focus:ring-indigo-400 transition"
          placeholder="Confirm password"
          [(ngModel)]="confirmPassword" />
      </div>

      <!-- ‚ùó Error -->
      @if (error()) {
        <p class="mt-3 text-sm text-red-600 animate-shake">
          {{ error() }}
        </p>
      }

      <!-- üîò CTA -->
      <button
        class="btn-primary w-full mt-7
               flex justify-center items-center gap-2
               shadow-lg hover:shadow-xl
               active:scale-95 transition"
        [disabled]="loading()"
        (click)="submit()">

        @if (loading()) {
          <span class="loader-sm"></span>
          Setting‚Ä¶
        } @else {
          Set Password
        }
      </button>
    }
  </div>
</div>
