<!-- BACKDROP -->
@if (open) {
  <div 
    class="fixed inset-0 z-40
           bg-black/10 backdrop-blur-sm
           transition-opacity duration-300"
    (click)="close.emit()">
  </div>
}

<!-- DROPDOWN -->
@if (open) {
  <div
    class="absolute right-0 mt-3 w-[340px] z-50
           rounded-3xl
           bg-white/80 backdrop-blur-xl
           border border-white/60
           shadow-[0_20px_40px_rgba(0,0,0,0.15)]
           origin-top-right
           animate-user-menu">

    <ul class="py-3" >

      <!-- PROFILE -->
      <li class="menu-row" (click)="openUserProfile()">
        <span class="menu-icon bg-indigo-100 text-indigo-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M4.5 20.25a7.5 7.5 0 0115 0" />
          </svg>
        </span>
        <span class="menu-text">Profile</span>
      </li>

      <!-- DARK MODE -->
      <!-- <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-sky-100 text-sky-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M21.752 15.002A9.718 9.718 0 0112.003 21
                 c-5.385 0-9.75-4.365-9.75-9.75
                 0-4.136 2.56-7.676 6.186-9.106
                 A7.501 7.501 0 0021.752 15z" />
          </svg>
        </span>

        <span class="menu-text flex-1">Dark mode</span>

        <label class="relative inline-flex items-center cursor-pointer">
          <input type="checkbox" class="sr-only peer" />
          <span
            class="w-11 h-6 rounded-full
                   bg-gray-300
                   peer-checked:bg-indigo-600
                   transition-colors duration-300
                   relative">
            <span
              class="absolute top-[2px] left-[2px]
                     w-5 h-5 rounded-full
                     bg-white shadow-md
                     transition-transform duration-300
                     peer-checked:translate-x-5">
            </span>
          </span>
        </label>
      </li> -->

      <!-- SETTINGS -->
      <!-- <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-purple-100 text-purple-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <circle cx="12" cy="12" r="3" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06
                 a2 2 0 11-2.83 2.83l-.06-.06
                 a1.65 1.65 0 00-1.82-.33
                 a1.65 1.65 0 00-1 1.51V21
                 a2 2 0 11-4 0v-.09
                 a1.65 1.65 0 00-1-1.51
                 a1.65 1.65 0 00-1.82.33l-.06.06
                 a2 2 0 11-2.83-2.83l.06-.06
                 a1.65 1.65 0 00.33-1.82
                 a1.65 1.65 0 00-1.51-1H3
                 a2 2 0 110-4h.09
                 a1.65 1.65 0 001.51-1
                 a1.65 1.65 0 00-.33-1.82l-.06-.06
                 a2 2 0 112.83-2.83l.06.06
                 a1.65 1.65 0 001.82.33H9
                 a1.65 1.65 0 001-1.51V3
                 a2 2 0 114 0v.09
                 a1.65 1.65 0 001 1.51
                 a1.65 1.65 0 001.82-.33l.06-.06
                 a2 2 0 112.83 2.83l-.06.06
                 a1.65 1.65 0 00-.33 1.82V11
                 a1.65 1.65 0 001.51 1H21
                 a2 2 0 110 4h-.09
                 a1.65 1.65 0 00-1.51 1z" />
          </svg>
        </span>
        <span class="menu-text">Settings</span>
      </li> -->

      <li class="menu-row" (click)="handleSetPassword()">
        <span class="menu-icon bg-indigo-100 text-indigo-600">
          <!-- Lock Icon -->
          <svg
            class="w-5 h-5"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.8"
            stroke-linecap="round"
            stroke-linejoin="round">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0110 0v4"></path>
          </svg>
        </span>

        <span class="menu-text">Set Password</span>
      </li>

      <!-- REPORT -->
      <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-amber-100 text-amber-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <circle cx="12" cy="12" r="9" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01" />
          </svg>
        </span>
        <span class="menu-text">Report an issue</span>
      </li>

      <!-- REFER -->
      <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-emerald-100 text-emerald-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M18 8a3 3 0 11-6 0 3 3 0 016 0zM6 8a3 3 0 116 0" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M2 20a6 6 0 0112 0M14 20a4 4 0 018 0" />
          </svg>
        </span>
        <span class="menu-text">Refer your friends</span>
      </li>

      <!-- LOGOUT -->
      <li class="menu-row text-red-600" (click)="logout()">
        <span class="menu-icon bg-red-100 text-red-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6
                 A2.25 2.25 0 005.25 5.25v13.5
                 A2.25 2.25 0 007.5 21h6
                 a2.25 2.25 0 002.25-2.25V15" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M18 12H9m0 0l3-3m-3 3l3 3" />
          </svg>
        </span>
        <span class="menu-text font-semibold">Sign out</span>
      </li>

    </ul>

    <!-- FOOTER -->
    <div class="border-t border-gray-200/60 px-6 py-4 text-sm text-gray-500 space-y-2">
      <div>Terms & Conditions · Privacy Policy</div>
      <div>About · Careers · Blog</div>

    <!-- SOCIAL ICONS -->
    <div class="flex gap-4 pt-2">
      <!-- Instagram -->
      <a
        href="#"
        aria-label="Instagram"
        class="flex h-10 w-10 items-center justify-center rounded-full
              bg-pink-50 text-pink-500
              transition hover:-translate-y-0.5 hover:bg-pink-500 hover:text-white"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5 fill-current">
          <path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm5 5a5 5 0 100 10 5 5 0 000-10zm6.5-.5a1 1 0 11-2 0 1 1 0 012 0z"/>
        </svg>
      </a>

      <!-- YouTube -->
      <a
        href="#"
        aria-label="YouTube"
        class="flex h-10 w-10 items-center justify-center rounded-full
              bg-red-50 text-red-500
              transition hover:-translate-y-0.5 hover:bg-red-500 hover:text-white"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5 fill-current">
          <path d="M23 7.5s-.2-1.7-.8-2.4a3 3 0 00-2.1-2.1C17.7 2.5 12 2.5 12 2.5s-5.7 0-8.1.5A3 3 0 001.8 5.1C1.2 5.8 1 7.5 1 7.5S.5 9.4.5 11.3v1.4c0 1.9.5 3.8.5 3.8s.2 1.7.8 2.4a3 3 0 002.1 2.1c2.4.5 8.1.5 8.1.5s5.7 0 8.1-.5a3 3 0 002.1-2.1c.6-.7.8-2.4.8-2.4s.5-1.9.5-3.8v-1.4c0-1.9-.5-3.8-.5-3.8zM10 15V9l5 3-5 3z"/>
        </svg>
      </a>

      <!-- X / Twitter -->
      <a
        href="#"
        aria-label="Twitter"
        class="flex h-10 w-10 items-center justify-center rounded-full
              bg-sky-50 text-sky-500
              transition hover:-translate-y-0.5 hover:bg-sky-500 hover:text-white"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5 fill-current">
          <path d="M18.2 2H21l-6.6 7.5L22 22h-6.6l-4.6-6-5.3 6H3l7-7.9L2 2h6.7l4.1 5.4L18.2 2z"/>
        </svg>
      </a>

      <!-- Facebook -->
      <a
        href="#"
        aria-label="Facebook"
        class="flex h-10 w-10 items-center justify-center rounded-full
              bg-blue-50 text-blue-600
              transition hover:-translate-y-0.5 hover:bg-blue-600 hover:text-white"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5 fill-current">
          <path d="M22 12a10 10 0 10-11.6 9.9v-7h-2v-3h2v-2.3c0-2 1.2-3.2 3.1-3.2.9 0 1.9.1 1.9.1v2.1h-1.1c-1.1 0-1.4.7-1.4 1.4V12h2.5l-.4 3h-2.1v7A10 10 0 0022 12z"/>
        </svg>
      </a>

      <!-- LinkedIn -->
      <a
        href="#"
        aria-label="LinkedIn"
        class="flex h-10 w-10 items-center justify-center rounded-full
              bg-blue-50 text-blue-700
              transition hover:-translate-y-0.5 hover:bg-blue-700 hover:text-white"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5 fill-current">
          <path d="M6.94 6.5A1.94 1.94 0 115 4.56 1.94 1.94 0 016.94 6.5zM5.5 8.75h2.88V19H5.5zM10.75 8.75h2.76v1.4h.04a3.03 3.03 0 012.72-1.5c2.9 0 3.44 1.9 3.44 4.37V19h-2.88v-4.78c0-1.14 0-2.6-1.59-2.6s-1.83 1.24-1.83 2.52V19h-2.88z"/>
        </svg>
      </a>
    </div>


      <div class="text-xs pt-2">
        © {{year}} QuizPlay Pvt Ltd
      </div>
    </div>

  </div>
}

<!-- ================= SET PASSWORD MODAL ================= -->
@if (showSetPassword()) {
  <div
    class="fixed inset-0 z-[9999]
           flex items-center justify-center
           bg-black/30 backdrop-blur-md
           animate-fade-scale-in"
    (click)="closeSetPassword()">

    <!-- STOP CLICK -->
    <div
      class="relative"
      (click)="$event.stopPropagation()">

      <app-set-password-modal
        (close)="closeSetPassword()">
      </app-set-password-modal>

    </div>
  </div>
}

<!-- ================= USER PROFILE MODAL ================= -->
@if (showUserProfile()) {
  <div
    class="fixed inset-0 z-[9999]
           flex items-center justify-center
           bg-black/30 backdrop-blur-md
           animate-fade-scale-in"
    (click)="closeUserProfile()">

    <!-- STOP CLICK -->
    <div
      class="relative"
      (click)="$event.stopPropagation()">

      <app-user-profile
        (close)="closeUserProfile()">
      </app-user-profile>

    </div>
  </div>
}



