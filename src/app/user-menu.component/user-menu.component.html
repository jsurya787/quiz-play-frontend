<!-- BACKDROP -->
@if (open) {
  <div 
    class="fixed inset-0 z-40
           bg-black/10 backdrop-blur-sm
           transition-opacity duration-300"
    (click)="close.emit()">
  </div>
}

<!-- DROPDOWN -->
@if (open) {
  <div
    class="absolute right-0 mt-3 w-[340px] z-50
           rounded-3xl
           bg-white/80 backdrop-blur-xl
           border border-white/60
           shadow-[0_20px_40px_rgba(0,0,0,0.15)]
           origin-top-right
           animate-user-menu">

    <ul class="py-3" >

      <!-- PROFILE -->
      <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-indigo-100 text-indigo-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M4.5 20.25a7.5 7.5 0 0115 0" />
          </svg>
        </span>
        <span class="menu-text">Profile</span>
      </li>

      <!-- DARK MODE -->
      <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-sky-100 text-sky-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M21.752 15.002A9.718 9.718 0 0112.003 21
                 c-5.385 0-9.75-4.365-9.75-9.75
                 0-4.136 2.56-7.676 6.186-9.106
                 A7.501 7.501 0 0021.752 15z" />
          </svg>
        </span>

        <span class="menu-text flex-1">Dark mode</span>

        <label class="relative inline-flex items-center cursor-pointer">
          <input type="checkbox" class="sr-only peer" />
          <span
            class="w-11 h-6 rounded-full
                   bg-gray-300
                   peer-checked:bg-indigo-600
                   transition-colors duration-300
                   relative">
            <span
              class="absolute top-[2px] left-[2px]
                     w-5 h-5 rounded-full
                     bg-white shadow-md
                     transition-transform duration-300
                     peer-checked:translate-x-5">
            </span>
          </span>
        </label>
      </li>

      <!-- SETTINGS -->
      <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-purple-100 text-purple-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <circle cx="12" cy="12" r="3" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06
                 a2 2 0 11-2.83 2.83l-.06-.06
                 a1.65 1.65 0 00-1.82-.33
                 a1.65 1.65 0 00-1 1.51V21
                 a2 2 0 11-4 0v-.09
                 a1.65 1.65 0 00-1-1.51
                 a1.65 1.65 0 00-1.82.33l-.06.06
                 a2 2 0 11-2.83-2.83l.06-.06
                 a1.65 1.65 0 00.33-1.82
                 a1.65 1.65 0 00-1.51-1H3
                 a2 2 0 110-4h.09
                 a1.65 1.65 0 001.51-1
                 a1.65 1.65 0 00-.33-1.82l-.06-.06
                 a2 2 0 112.83-2.83l.06.06
                 a1.65 1.65 0 001.82.33H9
                 a1.65 1.65 0 001-1.51V3
                 a2 2 0 114 0v.09
                 a1.65 1.65 0 001 1.51
                 a1.65 1.65 0 001.82-.33l.06-.06
                 a2 2 0 112.83 2.83l-.06.06
                 a1.65 1.65 0 00-.33 1.82V11
                 a1.65 1.65 0 001.51 1H21
                 a2 2 0 110 4h-.09
                 a1.65 1.65 0 00-1.51 1z" />
          </svg>
        </span>
        <span class="menu-text">Settings</span>
      </li>

      <!-- REPORT -->
      <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-amber-100 text-amber-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <circle cx="12" cy="12" r="9" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01" />
          </svg>
        </span>
        <span class="menu-text">Report an issue</span>
      </li>

      <!-- REFER -->
      <li class="menu-row" (click)="close.emit()">
        <span class="menu-icon bg-emerald-100 text-emerald-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M18 8a3 3 0 11-6 0 3 3 0 016 0zM6 8a3 3 0 116 0" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M2 20a6 6 0 0112 0M14 20a4 4 0 018 0" />
          </svg>
        </span>
        <span class="menu-text">Refer your friends</span>
      </li>

      <!-- LOGOUT -->
      <li class="menu-row text-red-600" (click)="logout()">
        <span class="menu-icon bg-red-100 text-red-600">
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6
                 A2.25 2.25 0 005.25 5.25v13.5
                 A2.25 2.25 0 007.5 21h6
                 a2.25 2.25 0 002.25-2.25V15" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M18 12H9m0 0l3-3m-3 3l3 3" />
          </svg>
        </span>
        <span class="menu-text font-semibold">Sign out</span>
      </li>

    </ul>

    <!-- FOOTER -->
    <div class="border-t border-gray-200/60 px-6 py-4 text-sm text-gray-500 space-y-2">
      <div>Terms & Conditions · Privacy Policy</div>
      <div>About · Careers · Blog</div>

      <div class="flex gap-3 pt-2">
        <span class="social-pill"></span>
        <span class="social-pill"></span>
        <span class="social-pill"></span>
        <span class="social-pill"></span>
        <span class="social-pill"></span>
      </div>

      <div class="text-xs pt-2">
        © 2026 Sorting Hat Technologies Pvt Ltd
      </div>
    </div>

  </div>
}
