<section
  class="relative py-32 px-6 overflow-hidden
         bg-gradient-to-br from-indigo-100/60 via-white to-sky-100/60">

  <!-- Decorative Blobs -->
  <div
    class="absolute -top-24 -left-24 h-96 w-96
           rounded-full bg-indigo-300/20 blur-3xl
           animate-float-slow">
  </div>

  <div
    class="absolute bottom-1/4 -right-32 h-96 w-96
           rounded-full bg-sky-300/20 blur-3xl
           animate-float-slower">
  </div>

  <div class="relative max-w-7xl mx-auto text-center">

    <!-- ===================== -->
    <!-- üîπ SKELETON STATE -->
    <!-- ===================== -->
    @if (loading()) {

      <div class="relative">

        <!-- Glass overlay -->
        <div class="absolute inset-0 bg-white/40 backdrop-blur-sm"></div>

        <div class="relative z-10">

          <!-- HERO SKELETON -->
          <div class="mb-24 text-center">

            <div
              class="h-12 w-3/4 max-w-xl mx-auto
                     rounded-xl skeleton-shimmer mb-6">
            </div>

            <div class="space-y-3 max-w-2xl mx-auto">
              <div class="h-4 w-full rounded skeleton-shimmer"></div>
              <div class="h-4 w-5/6 mx-auto rounded skeleton-shimmer"></div>
            </div>

            <div class="mt-10 flex justify-center gap-4">
              <div class="h-12 w-40 rounded-full skeleton-shimmer"></div>
              <div class="h-12 w-32 rounded-full skeleton-shimmer"></div>
            </div>
          </div>

          <!-- GRID SKELETON -->
          <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">

            @for (i of [1,2,3,4,5,6]; track $index) {

              <div
                class="relative rounded-2xl
                       bg-white/70 backdrop-blur
                       border border-white/30
                       shadow-lg overflow-hidden">

                <div class="h-1.5 skeleton-shimmer"></div>

                <div class="p-6 text-left">

                  <div class="flex items-center justify-between mb-5">
                    <div class="flex items-center gap-3">
                      <div class="w-12 h-12 rounded-xl skeleton-shimmer"></div>

                      <div class="space-y-2">
                        <div class="h-4 w-28 rounded skeleton-shimmer"></div>
                        <div class="h-3 w-20 rounded skeleton-shimmer"></div>
                      </div>
                    </div>

                    <div class="h-6 w-14 rounded-full skeleton-shimmer"></div>
                  </div>

                  <div class="space-y-2 mb-5">
                    <div class="h-3 w-full rounded skeleton-shimmer"></div>
                    <div class="h-3 w-5/6 rounded skeleton-shimmer"></div>
                  </div>

                  <div class="flex gap-2 mb-6">
                    <div class="h-6 w-16 rounded-full skeleton-shimmer"></div>
                    <div class="h-6 w-20 rounded-full skeleton-shimmer"></div>
                    <div class="h-6 w-14 rounded-full skeleton-shimmer"></div>
                  </div>

                  <div class="h-11 w-full rounded-xl skeleton-shimmer"></div>
                </div>
              </div>
            }
          </div>
        </div>
      </div>
    }

    <!-- ===================== -->
    <!-- üîπ REAL CONTENT -->
    <!-- ===================== -->
    @else {

      <div class="animate-fade-in">

        <h2 class="text-3xl md:text-5xl font-extrabold mb-4 text-gray-900">
          Master Your Subjects
        </h2>

        <p class="text-gray-600 max-w-2xl mx-auto mb-20">
          Practice chapter-wise quizzes designed strictly according
          to Class 10 & 12 syllabus.
        </p>

        @if (authService.isAdmin()) {
          <div class="mb-12 flex justify-center">
            <button
              class="px-6 py-3 rounded-xl
                     bg-indigo-600 text-white
                     text-sm font-semibold
                     hover:bg-indigo-700 transition"
              (click)="openAdd()">
              + Add Subject
            </button>
          </div>
        }

        <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">

          @for (s of subjectService.subjects(); track $index) {

            <div
              class="group relative rounded-2xl
                     bg-white/80 backdrop-blur
                     border border-gray-100
                     shadow-sm transition-all duration-300
                     hover:shadow-xl hover:-translate-y-1
                     hover:ring-1 hover:ring-indigo-200/60">
                     <!-- ACTION ICONS -->
            @if (authService.isAdmin()) {
              <div
                class="absolute top-3 right-3 z-10
                      flex gap-2
                      opacity-0 scale-95
                      transition-all duration-200
                      group-hover:opacity-100 group-hover:scale-100">

                <!-- Edit -->
                <button
                  (click)="editSubject(s); $event.stopPropagation()"
                  class="w-9 h-9 flex items-center justify-center
                        rounded-full
                        bg-white/90 backdrop-blur
                        border border-gray-200
                        text-indigo-600
                        shadow-sm
                        hover:bg-indigo-50 hover:scale-105
                        transition"
                  title="Edit">
                  ‚úèÔ∏è
                </button>

                <!-- Delete -->
                <button
                  (click)="deleteSubject(s); $event.stopPropagation()"
                  class="w-9 h-9 flex items-center justify-center
                        rounded-full
                        bg-white/90 backdrop-blur
                        border border-gray-200
                        text-red-500
                        shadow-sm
                        hover:bg-red-50 hover:scale-105
                        transition"
                  title="Delete">
                  üóë
                </button>

              </div>
            }

              <div
                class="h-1.5 rounded-t-2xl"
                [ngClass]="s.color || 'from-emerald-500 to-green-600'">
              </div>

              <div class="p-6 text-left">

                <div class="flex items-center justify-between mb-4">
                  <div class="flex items-center gap-3">
                    <img
                      [src]="s.logoUrl"
                      class="w-12 h-12"
                      alt="" />

                    <div>
                      <h3 class="text-lg font-semibold text-gray-900">
                        {{ s.name }}
                      </h3>
                      <p class="text-xs text-gray-500">
                        {{ s.subjectClass }}
                      </p>
                    </div>
                  </div>

                  <span
                    class="px-2 py-1 rounded-full text-xs font-semibold
                           bg-indigo-50 text-indigo-600">
                    Quiz
                  </span>
                </div>

                <p class="text-sm text-gray-600 mb-4">
                  {{ s.description }}
                </p>

                <div class="mb-5">
                  <p class="text-xs font-semibold text-gray-500 mb-2">
                    Key chapters
                  </p>

                  <div class="flex flex-wrap gap-2">
                    @for (item of s.keyPoints; track $index) {
                      <span
                        class="px-2.5 py-1 rounded-full text-xs
                               bg-gray-100 text-gray-700">
                        {{ item }}
                      </span>
                    }
                  </div>
                </div>

                <button
                  class="w-full mt-2 flex items-center justify-center gap-2
                         px-4 py-2.5 rounded-xl
                         bg-indigo-600 text-white
                         text-sm font-semibold transition-all
                         hover:bg-indigo-700 group-hover:gap-3"
                  [routerLink]="['subject-page/', s._id]">
                  Start Practicing ‚Üí
                </button>

              </div>
            </div>
          }
        </div>
      </div>
    }
  </div>
</section>

@if (authService.isAdmin()) {
  <app-subject-form-modal
    [visible]="showModal()"
    [isEdit]="isEdit()"
    [subject]="selectedSubject()"
    (closeModal)="closeModal()"
    (submitForm)="saveSubject($event)">
  </app-subject-form-modal>
}
